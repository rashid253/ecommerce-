<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Admin Panel - Edit Page Content</title>
  <!-- Firebase Libraries -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <style>
    /* Basic Reset */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: Arial, sans-serif;
      display: flex;
      height: 100vh;
      overflow: hidden;
    }
    /* Sidebar styles */
    .sidebar {
      width: 250px;
      background-color: #2c3e50;
      color: #ecf0f1;
      padding: 20px;
      overflow-y: auto;
    }
    .sidebar h2 { margin-bottom: 15px; }
    .sidebar ul { list-style: none; }
    .sidebar li {
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 4px;
      cursor: pointer;
    }
    .sidebar li:hover, .sidebar li.active {
      background-color: #34495e;
    }
    /* Content area styles */
    .content {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
    }
    .content h2 { margin-bottom: 15px; }
    .form-group { margin-bottom: 15px; }
    label { display: block; margin-bottom: 5px; }
    input[type="text"], textarea {
      width: 100%;
      padding: 8px;
      border: 1px solid #bdc3c7;
      border-radius: 4px;
    }
    button {
      padding: 10px 15px;
      border: none;
      border-radius: 4px;
      background-color: #27ae60;
      color: white;
      cursor: pointer;
    }
    button:hover { background-color: #2ecc71; }
    .message { margin-top: 10px; font-weight: bold; }
  </style>
</head>
<body>
  <div class="sidebar">
    <h2>Pages</h2>
    <ul id="pagesList">
      <!-- List of pages will be dynamically populated -->
    </ul>
  </div>
  <div class="content">
    <h2>Edit Page Content</h2>
    <form id="pageForm">
      <div class="form-group">
        <label for="pageId">Page ID</label>
        <input type="text" id="pageId" readonly>
      </div>
      <div class="form-group">
        <label for="title">Page Title</label>
        <input type="text" id="title" placeholder="Enter page title">
      </div>
      <div class="form-group">
        <label for="description">Page Description</label>
        <textarea id="description" rows="4" placeholder="Enter page description"></textarea>
      </div>
      <div class="form-group">
        <label for="backgroundVideo">Background Video URL</label>
        <input type="text" id="backgroundVideo" placeholder="Enter background video URL">
      </div>
      <div class="form-group">
        <label for="heroImage">Hero Image URL</label>
        <input type="text" id="heroImage" placeholder="Enter hero image URL">
      </div>
      <button type="submit">Save Changes</button>
      <div class="message" id="formMessage"></div>
    </form>
  </div>

  <script>
    // TODO: Replace with your actual Firebase project configuration
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "e-commerce-pk.firebaseapp.com",
      projectId: "e-commerce-pk",
      storageBucket: "e-commerce-pk.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Predefined list of pages (update as needed)
    const pages = ["index", "ecommerce", "about", "delivery", "offers", "payments", "support", "contact"];
    const pagesList = document.getElementById("pagesList");
    const pageForm = document.getElementById("pageForm");
    const formMessage = document.getElementById("formMessage");

    let currentPage = null;

    // Render the list of pages in the sidebar
    function renderPagesList() {
      pagesList.innerHTML = "";
      pages.forEach(page => {
        const li = document.createElement("li");
        li.textContent = page;
        li.addEventListener("click", () => {
          // Highlight the active page
          Array.from(pagesList.children).forEach(child => child.classList.remove("active"));
          li.classList.add("active");
          loadPageContent(page);
        });
        pagesList.appendChild(li);
      });
    }

    // Load page content from Firestore
    function loadPageContent(pageId) {
      currentPage = pageId;
      document.getElementById("pageId").value = pageId;
      // Fetch document from 'pages' collection
      db.collection("pages").doc(pageId).get()
        .then(doc => {
          if (doc.exists) {
            const data = doc.data();
            document.getElementById("title").value = data.title || "";
            document.getElementById("description").value = data.description || "";
            document.getElementById("backgroundVideo").value = data.backgroundVideo || "";
            document.getElementById("heroImage").value = data.heroImage || "";
          } else {
            // If the document doesn't exist, clear the form
            document.getElementById("title").value = "";
            document.getElementById("description").value = "";
            document.getElementById("backgroundVideo").value = "";
            document.getElementById("heroImage").value = "";
          }
          formMessage.textContent = "";
        })
        .catch(error => {
          console.error("Error loading page content:", error);
          formMessage.textContent = "Error loading content: " + error.message;
        });
    }

    // Handle form submission to update Firestore
    pageForm.addEventListener("submit", (e) => {
      e.preventDefault();
      if (!currentPage) {
        formMessage.textContent = "Please select a page to edit.";
        return;
      }
      const pageData = {
        title: document.getElementById("title").value,
        description: document.getElementById("description").value,
        backgroundVideo: document.getElementById("backgroundVideo").value,
        heroImage: document.getElementById("heroImage").value,
        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
      };
      db.collection("pages").doc(currentPage).set(pageData, { merge: true })
        .then(() => {
          formMessage.textContent = "Page content updated successfully!";
        })
        .catch(error => {
          console.error("Error updating content:", error);
          formMessage.textContent = "Error updating content: " + error.message;
        });
    });

    // Initialize the admin panel
    renderPagesList();
    // Optionally, load the first page by default
    if (pages.length > 0) {
      loadPageContent(pages[0]);
      pagesList.firstChild.classList.add("active");
    }
  </script>
</body>
</html>
